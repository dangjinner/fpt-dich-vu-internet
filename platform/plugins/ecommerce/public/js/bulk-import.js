$((function(){var e=$(".alert.alert-warning");e.length>0&&_.map(e,(function(e){var t=localStorage.getItem("storage-alerts");if(t=t?JSON.parse(t):{},$(e).data("alert-id")){if(t[$(e).data("alert-id")])return void $(e).alert("close");$(e).removeClass("hidden")}})),e.on("closed.bs.alert",(function(e){var t=$(e.target).data("alert-id");if(t){var a=localStorage.getItem("storage-alerts");(a=a?JSON.parse(a):{})[t]=!0,localStorage.setItem("storage-alerts",JSON.stringify(a))}}));var t=!1;$(document).on("click",".download-template",(function(e){if(e.preventDefault(),!t){var a=$(e.currentTarget),r=a.data("extension"),o=a.html();$.ajax({url:a.data("url"),method:"POST",data:{extension:r},xhrFields:{responseType:"blob"},beforeSend:function(){a.html(a.data("downloading")),a.addClass("text-secondary"),t=!0},success:function(e){var t=document.createElement("a"),r=window.URL.createObjectURL(e);t.href=r,t.download=a.data("filename"),document.body.append(t),t.click(),t.remove(),window.URL.revokeObjectURL(r)},error:function(e){Botble.handleError(e)},complete:function(){setTimeout((function(){a.html(o),a.removeClass("text-secondary"),t=!1}),2e3)}})}})),$(document).on("submit",".form-import-data",(function(e){e.preventDefault();var t=$(this),a=new FormData(t.get(0)),r=t.find("button[type=submit]"),o=$("#imported-message"),n=$("#imported-listing"),s=$(".show-errors"),l=$("#failure-template").html();$(".main-form-message").addClass("hidden"),o.html(""),n.html(""),$httpClient.make().withButtonLoading(r).withLoading(t).post(t.attr("action"),a).then((function(e){var a=e.data;a.error?Botble.showError(a.message):Botble.showSuccess(a.message);var r="";a.data.failures&&_.map(a.data.failures,(function(e){r+=l.replace("__row__",e.row).replace("__attribute__",e.attribute).replace("__errors__",e.errors.join(", "))}));var i="alert alert-success";a.data.total_failed?(i=a.data.total_success?"alert alert-warning":"alert alert-danger",s.removeClass("hidden")):s.addClass("hidden"),o.removeClass().addClass(i).html(a.message),r&&n.removeClass("hidden").html(r),t.trigger("reset")})).finally((function(){$(".main-form-message").removeClass("hidden")}))}))}));